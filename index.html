<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#ff69b4">
    <meta name="description" content="Jeu de mots croisÃ©s chrÃ©tiens avec un design kawaii rose Ã©lÃ©gant">
    <title>ğŸ’• Mots En Croix ChrÃ©tiens ğŸ’•</title>
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff69b4">
    
    <!-- iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Mots Croix">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-192x192.png">
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-192x192.png">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/info-banner.css">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Fond animÃ© avec lignes ondulÃ©es -->
    <div class="background-waves">
        <div class="wave wave-1"></div>
        <div class="wave wave-2"></div>
        <div class="wave wave-3"></div>
        <div class="wave wave-4"></div>
    </div>

    <!-- Ã‰toiles scintillantes -->
    <div class="background-stars">
        <div class="star s1"></div>
        <div class="star s2"></div>
        <div class="star s3"></div>
        <div class="star s4"></div>
        <div class="star s5"></div>
    </div>

    <div class="game-container">
        <div class="header">
            <h1>ğŸ™ Mots En Croix ChrÃ©tiens ğŸ™</h1>
            <p>Trouve les mots d'encouragement et les mots bibliques</p>
            <button id="installButton" class="install-button hidden">
                ğŸ“± Installer l'Application
            </button>
            <button id="menuButton" class="menu-button">
                â˜° Menu
            </button>
            <button id="audioToggleButton" class="audio-toggle-button" title="Activer/DÃ©sactiver le son">
                ğŸ”Š
            </button>
        </div>

        <!-- Bandeau Info dÃ©filant -->
        <div class="info-banner" id="infoBanner">
            <div class="info-banner-content">
                <!-- Stats fixes (ne dÃ©filent pas) -->
                <div class="info-fixed">
                    <div class="info-stat">
                        <span class="info-stat-icon">ğŸ“Š</span>
                        <span>Niveau <span class="info-stat-value" id="infoBannerLevel">1</span>/<span id="infoBannerMaxLevel">77</span></span>
                    </div>
                    <div class="info-stat">
                        <span class="info-stat-icon">â­</span>
                        <span class="info-stat-value" id="infoBannerScore">0</span>
                    </div>
                    <div class="info-stat">
                        <span class="info-stat-icon">ğŸ†</span>
                        <span>Max: <span class="info-stat-value" id="infoBannerMaxScore">0</span></span>
                    </div>
                </div>

                <!-- Messages dÃ©filants -->
                <div class="info-scrolling">
                    <div class="info-messages" id="infoMessages">
                        <!-- Messages gÃ©nÃ©rÃ©s dynamiquement -->
                    </div>
                </div>
            </div>
            
            <!-- Barre de progression (optionnelle) -->
            <div class="info-progress">
                <div class="info-progress-bar" id="infoProgressBar" style="width: 0%"></div>
            </div>
        </div>

        <!-- Interface Chat simplifiÃ©e -->
        <div id="chatSmsContainer" class="chat-sms-container hidden">
            <div class="chat-sms-input-container">
                <input type="text" id="chatSmsInput" class="chat-sms-input" placeholder="Ã‰crire ici..." maxlength="100">
                <button id="chatSmsSend" class="chat-sms-send">ğŸ“¤</button>
            </div>
            <div id="chatSmsMessages" class="chat-sms-messages">
                <!-- Messages apparaissent ici -->
            </div>
        </div>

        <div id="startScreen">
            <button class="play-button" id="playButton">
                ğŸ® Jouer (<span id="clickCount">0</span>/7)
            </button>
            <div class="encouraging-words" id="encouragingWords"></div>
        </div>

        <div id="gameScreen" class="hidden">
            <!-- Boutons de course en haut de la grille -->
            <div class="race-controls">
                <!-- Box info points des joueurs -->
                <div id="raceScoreBox" class="race-score-box" style="display: none;">
                    <div class="race-score-header">ğŸ“Š Scores en Direct</div>
                    <div id="raceScoreList" class="race-score-list">
                        <!-- Scores gÃ©nÃ©rÃ©s dynamiquement -->
                    </div>
                </div>
                
                <button id="startRaceButton" class="race-button" style="display: none;">ğŸ DÃ©marrer Course</button>
                <button id="stopRaceButton" class="race-button stop" style="display: none;">â¹ï¸ ArrÃªter</button>
            </div>
            
            <!-- Tableau des joueurs en course -->
            <div id="racePlayersPanel" class="race-players-panel" style="display: none;">
                <div class="race-players-header">ğŸ‘¥ Joueurs en Course</div>
                <div id="racePlayersList" class="race-players-list">
                    <!-- Liste des joueurs gÃ©nÃ©rÃ©e dynamiquement -->
                </div>
            </div>
            
            <div class="crossword-grid" id="crosswordGrid"></div>
            
            <div class="word-clues">
                <div class="clue-section">
                    <h3><span class="arrow-icon arrow-right"></span></h3>
                    <div id="horizontalClues"></div>
                </div>
                <div class="clue-section">
                    <h3><span class="arrow-icon arrow-down"></span></h3>
                    <div id="verticalClues"></div>
                </div>
            </div>

            <div class="controls">
                <button class="control-btn" id="checkButton">âœ… VÃ©rifier</button>
                <button class="control-btn" id="hintButton">ğŸ’¡ Indice</button>
                <button class="control-btn" id="shareButton" style="display:none;">ğŸ“¤ Partager</button>
                <button class="control-btn" id="nextLevelButton" style="display:none;">â¡ï¸ Niveau Suivant</button>
                <button class="control-btn" id="resetButton">ğŸ”„ Recommencer</button>
            </div>
        </div>
    </div>

    <!-- Modal Kawaii pour les notifications -->
    <div id="kawaiiModal" class="kawaii-modal hidden">
        <div class="kawaii-modal-overlay"></div>
        <div class="kawaii-modal-content">
            <div class="kawaii-modal-header">
                <span class="kawaii-modal-icon">âœ¨</span>
            </div>
            <div class="kawaii-modal-body">
                <p id="kawaiiModalMessage"></p>
            </div>
            <div class="kawaii-modal-footer">
                <button id="kawaiiModalBtn" class="kawaii-modal-button">OK</button>
            </div>
        </div>
    </div>

    <!-- Modal pour sauvegarder le score -->
    <div id="scoreModal" class="kawaii-modal hidden">
        <div class="kawaii-modal-overlay"></div>
        <div class="kawaii-modal-content">
            <div class="kawaii-modal-header">
                <span class="kawaii-modal-icon">ğŸ†</span>
            </div>
            <div class="kawaii-modal-body">
                <p><strong>FÃ©licitations ! ğŸ‰</strong></p>
                <p>Votre score: <span id="finalScoreDisplay">0</span> points</p>
                <p>Sauvegarder votre score en ligne:</p>
                <form id="scoreForm">
                    <input type="text" id="playerName" placeholder="Votre nom" required>
                    <input type="email" id="playerEmail" placeholder="Votre email" required>
                </form>
            </div>
            <div class="kawaii-modal-footer">
                <button id="saveScoreBtn" class="kawaii-modal-button">ğŸ’¾ Sauvegarder</button>
                <button id="skipScoreBtn" class="kawaii-modal-button secondary">Passer</button>
            </div>
        </div>
    </div>

    <!-- Modal de connexion cloud -->
    <div id="cloudModal" class="kawaii-modal hidden">
        <div class="kawaii-modal-overlay"></div>
        <div class="kawaii-modal-content">
            <div class="kawaii-modal-header">
                <span class="kawaii-modal-icon">â˜ï¸</span>
            </div>
            <div class="kawaii-modal-body">
                <p><strong>Connexion Cloud</strong></p>
                <p>Connectez-vous pour sauvegarder automatiquement vos scores en ligne</p>
                <form id="cloudForm">
                    <input type="text" id="cloudPlayerName" placeholder="Votre nom" required>
                    <input type="email" id="cloudPlayerEmail" placeholder="Votre email" required>
                </form>
            </div>
            <div class="kawaii-modal-footer">
                <button id="cloudConnectSubmitBtn" class="kawaii-modal-button">âœ… Se connecter</button>
                <button id="cloudCancelBtn" class="kawaii-modal-button secondary">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal de menu -->
    <div id="menuModal" class="kawaii-modal hidden">
        <div class="kawaii-modal-overlay"></div>
        <div class="kawaii-modal-content menu-modal-content">
            <div class="menu-header">
                <h2 id="menuTitle">âš™ï¸ ParamÃ¨tres</h2>
                <button id="closeMenuBtn" class="close-menu-btn">âœ•</button>
            </div>

            <!-- Onglets de navigation -->
            <div class="menu-tabs">
                <button class="menu-tab active" data-tab="settings">
                    âš™ï¸ Menu
                </button>
                <button class="menu-tab" data-tab="connexion">
                    ğŸ‘¤ Connexion
                </button>
                <button class="menu-tab" data-tab="leaderboard">
                    ğŸ† Score
                </button>
            </div>

            <!-- Contenu Onglet Menu -->
            <div id="settingsTabContent" class="menu-tab-content active">
                <div class="menu-section">
                <h3>ğŸ‘¤ Profil</h3>
                <div id="profileSection">
                    <p id="profileUsername" style="font-size: 16px; font-weight: bold; color: #ff1493; margin-bottom: 10px;">Non connectÃ©</p>
                    <button id="changeUsernameBtn" class="menu-cloud-btn" style="display: none;">
                        âœï¸ Modifier le pseudo
                    </button>
                    <button id="signOutBtn" class="menu-cloud-btn secondary" style="display: none; margin-top: 10px;">
                        ğŸšª DÃ©connexion
                    </button>
                </div>
                <p class="menu-description">GÃ©rez votre compte et vos informations</p>
            </div>

            <div class="menu-section">
                <h3>ğŸ† Collection de MÃ©dailles</h3>
                <button id="achievementsBtn" class="menu-cloud-btn">
                    ğŸ† Voir mes mÃ©dailles
                </button>
                <p class="menu-description">Consultez vos rÃ©compenses et achievements</p>
            </div>

            <div class="menu-section">
                <h3>ğŸŒ Langue / Language</h3>
                <div id="menuLanguageSelector" class="menu-language-selector"></div>
            </div>

            <div class="menu-section">
                <h3>ğŸ”Š Audio</h3>
                <div class="audio-controls">
                    <div class="audio-control-item">
                        <label for="musicVolume">ğŸµ Musique</label>
                        <input type="range" id="musicVolume" min="0" max="100" value="50">
                        <span id="musicVolumeValue">50%</span>
                    </div>
                    <div class="audio-control-item">
                        <label for="soundVolume">ğŸ”” Effets sonores</label>
                        <input type="range" id="soundVolume" min="0" max="100" value="50">
                        <span id="soundVolumeValue">50%</span>
                    </div>
                </div>
            </div>

                <div class="menu-section">
                    <h3>â„¹ï¸ Ã€ propos</h3>
                    <div class="about-info">
                        <p class="about-item">
                            <strong>ğŸ¨ Artiste:</strong>
                            <a href="#" id="artistLink" class="info-link">Voir le profil</a>
                        </p>
                        <p class="about-item">
                            <strong>âœ¨ CrÃ©ation:</strong> Jeu de mots croisÃ©s chrÃ©tiens avec design kawaii
                        </p>
                        <p class="about-item">
                            <strong>ğŸ’» Codage:</strong> DÃ©veloppÃ© avec Claude Code Pro
                        </p>
                    </div>
                </div>
            </div>

            <!-- Contenu Onglet Score/Leaderboard -->
            <div id="leaderboardTabContent" class="menu-tab-content">
                <div class="leaderboard-header">
                    <h3>ğŸ† Tableau des Scores</h3>
                    <button id="refreshLeaderboardBtn" class="menu-cloud-btn" style="margin: 10px 0;">
                        ğŸ”„ Actualiser
                    </button>
                </div>
                <div id="leaderboardContainer" class="leaderboard-container">
                    <p style="text-align: center; color: #666;">Chargement des scores...</p>
                </div>
                <div style="text-align: center; margin-top: 15px;">
                    <button id="viewFullLeaderboardBtn" class="menu-cloud-btn secondary">
                        ğŸ“Š Voir le classement complet
                    </button>
                </div>
            </div>

            <!-- Contenu Onglet Connexion -->
            <div id="connexionTabContent" class="menu-tab-content">
                <div class="connexion-header" style="text-align: center; margin-bottom: 20px;">
                    <h3>ğŸ‘¤ Connexion / Inscription</h3>
                    <p style="color: #666; font-size: 14px;">Sauvegardez vos scores en ligne</p>
                </div>

                <div id="connexionSection">
                    <!-- Formulaire de connexion/inscription -->
                    <div id="authForm" class="auth-form">
                        <div class="menu-section">
                            <input type="text" id="authUsername" placeholder="Nom d'utilisateur" class="kawaii-input" style="width: 100%; margin-bottom: 10px; padding: 12px; border: 2px solid #ff69b4; border-radius: 10px;">
                            <input type="email" id="authEmail" placeholder="Email" class="kawaii-input" style="width: 100%; margin-bottom: 10px; padding: 12px; border: 2px solid #ff69b4; border-radius: 10px;">
                            <input type="password" id="authPassword" placeholder="Mot de passe" class="kawaii-input" style="width: 100%; margin-bottom: 15px; padding: 12px; border: 2px solid #ff69b4; border-radius: 10px;">
                            
                            <button id="signInBtn" class="menu-cloud-btn" style="width: 100%; margin-bottom: 10px;">
                                ğŸ”“ Se connecter
                            </button>
                            <button id="signUpBtn" class="menu-cloud-btn secondary" style="width: 100%; margin-bottom: 10px;">
                                âœ¨ CrÃ©er un compte
                            </button>
                        </div>
                        
                        <div style="text-align: center; margin-top: 15px; padding-top: 15px; border-top: 1px solid #ffe0f0;">
                            <p style="font-size: 12px; color: #999;">Vos donnÃ©es sont sÃ©curisÃ©es â˜ï¸</p>
                        </div>
                    </div>

                    <!-- Section profil (visible quand connectÃ©) -->
                    <div id="profileInfo" class="profile-info" style="display: none;">
                        <div class="menu-section" style="text-align: center;">
                            <!-- Avatar personnalisable -->
                            <div style="margin-bottom: 15px; position: relative;">
                                <div id="currentAvatar" style="font-size: 64px; cursor: pointer; display: inline-block; transition: transform 0.2s;" onclick="document.getElementById('avatarSelector').style.display = document.getElementById('avatarSelector').style.display === 'none' ? 'block' : 'none'">ğŸ‘¤</div>
                                <div style="font-size: 11px; color: #999; margin-top: 5px;">âœ¨ Cliquez pour changer</div>
                            </div>
                            
                            <!-- SÃ©lecteur d'avatars -->
                            <div id="avatarSelector" class="avatar-selector" style="display: none; background: #fff; border: 2px solid #ff69b4; border-radius: 15px; padding: 15px; margin-bottom: 15px; max-height: 300px; overflow-y: auto;">
                                <p style="font-size: 13px; color: #666; margin-bottom: 10px; font-weight: bold;">Choisissez votre avatar</p>
                                <div class="avatar-grid" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px;">
                                    <!-- Avatars gratuits (0 points) -->
                                    <div class="avatar-option" data-avatar="ğŸ˜Š" data-unlock="0" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ˜Š</div>
                                    <div class="avatar-option" data-avatar="ğŸ˜‡" data-unlock="0" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ˜‡</div>
                                    <div class="avatar-option" data-avatar="ğŸ¥°" data-unlock="0" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ¥°</div>
                                    <div class="avatar-option" data-avatar="ğŸ˜" data-unlock="0" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ˜</div>
                                    <div class="avatar-option" data-avatar="ğŸ¤—" data-unlock="0" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ¤—</div>
                                    <!-- 100 points -->
                                    <div class="avatar-option" data-avatar="ğŸ˜" data-unlock="100" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ˜</div>
                                    <div class="avatar-option" data-avatar="ğŸ¤©" data-unlock="100" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ¤©</div>
                                    <div class="avatar-option" data-avatar="ğŸ˜‹" data-unlock="100" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ˜‹</div>
                                    <div class="avatar-option" data-avatar="ğŸ˜º" data-unlock="100" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ˜º</div>
                                    <div class="avatar-option" data-avatar="ğŸ¥³" data-unlock="100" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ¥³</div>
                                    <!-- 250 points - Fleurs -->
                                    <div class="avatar-option" data-avatar="ğŸŒ¸" data-unlock="250" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸŒ¸</div>
                                    <div class="avatar-option" data-avatar="ğŸŒº" data-unlock="250" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸŒº</div>
                                    <div class="avatar-option" data-avatar="ğŸŒ»" data-unlock="250" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸŒ»</div>
                                    <div class="avatar-option" data-avatar="ğŸŒ·" data-unlock="250" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸŒ·</div>
                                    <div class="avatar-option" data-avatar="ğŸŒ¹" data-unlock="250" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸŒ¹</div>
                                    <!-- 500 points - Ã‰toiles -->
                                    <div class="avatar-option" data-avatar="ğŸŒŸ" data-unlock="500" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸŒŸ</div>
                                    <div class="avatar-option" data-avatar="â­" data-unlock="500" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">â­</div>
                                    <div class="avatar-option" data-avatar="âœ¨" data-unlock="500" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">âœ¨</div>
                                    <div class="avatar-option" data-avatar="ğŸ’«" data-unlock="500" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ’«</div>
                                    <div class="avatar-option" data-avatar="ğŸŒˆ" data-unlock="500" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸŒˆ</div>
                                    <!-- 750 points - CÅ“urs -->
                                    <div class="avatar-option" data-avatar="ğŸ’" data-unlock="750" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ’</div>
                                    <div class="avatar-option" data-avatar="ğŸ’–" data-unlock="750" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ’–</div>
                                    <div class="avatar-option" data-avatar="ğŸ’—" data-unlock="750" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ’—</div>
                                    <div class="avatar-option" data-avatar="ğŸ’•" data-unlock="750" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ’•</div>
                                    <div class="avatar-option" data-avatar="ğŸ¦‹" data-unlock="750" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ¦‹</div>
                                    <!-- 1000 points - Animaux premium -->
                                    <div class="avatar-option" data-avatar="ğŸ°" data-unlock="1000" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ°</div>
                                    <div class="avatar-option" data-avatar="ğŸ±" data-unlock="1000" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ±</div>
                                    <div class="avatar-option" data-avatar="ğŸ¶" data-unlock="1000" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ¶</div>
                                    <div class="avatar-option" data-avatar="ğŸ¼" data-unlock="1000" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ¼</div>
                                    <div class="avatar-option" data-avatar="ğŸ¦Š" data-unlock="1000" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ¦Š</div>
                                    <!-- 1500 points - Animaux lÃ©gendaires -->
                                    <div class="avatar-option" data-avatar="ğŸ»" data-unlock="1500" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ»</div>
                                    <div class="avatar-option" data-avatar="ğŸ¨" data-unlock="1500" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ¨</div>
                                    <div class="avatar-option" data-avatar="ğŸ¯" data-unlock="1500" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ¯</div>
                                    <div class="avatar-option" data-avatar="ğŸ¦" data-unlock="1500" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸ¦</div>
                                    <div class="avatar-option" data-avatar="ğŸµ" data-unlock="1500" style="font-size: 32px; cursor: pointer; padding: 8px; border-radius: 10px; transition: all 0.2s;">ğŸµ</div>
                                </div>
                            </div>
                            
                            <p id="connectedUsername" style="font-size: 18px; font-weight: bold; color: #ff1493; margin-bottom: 5px;">Utilisateur</p>
                            <p id="connectedEmail" style="font-size: 14px; color: #666; margin-bottom: 20px;">email@example.com</p>
                            
                            <div style="background: #fff5f9; padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                                <p style="font-size: 14px; color: #666; margin-bottom: 5px;">Meilleur Score</p>
                                <p id="userMaxScore" style="font-size: 32px; font-weight: bold; color: #ff1493;">0</p>
                            </div>
                            
                            <button id="shareScoreBtn" class="menu-cloud-btn" style="width: 100%; margin-bottom: 10px; background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);">
                                ğŸ“¤ Partager mon score
                            </button>
                            <button id="editProfileBtn" class="menu-cloud-btn" style="width: 100%; margin-bottom: 10px;">
                                âœï¸ Modifier pseudo
                            </button>
                            <button id="signOutProfileBtn" class="menu-cloud-btn secondary" style="width: 100%;">
                                ğŸšª DÃ©connexion
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Section Chat Multijoueur (visible quand connectÃ©) -->
                <div id="chatMultiplayerSection" class="menu-section" style="display: none; margin-top: 20px; border-top: 2px solid #ffe0f0; padding-top: 20px;">
                    <div class="menu-chat-header">
                        <div class="chat-header-info">
                            <span class="chat-icon">ğŸ’¬</span>
                            <span class="chat-title">Chat Multijoueur</span>
                            <span id="chatParticipantCount" class="chat-participant-count">0 ğŸ‘¥</span>
                        </div>
                    </div>

                    <!-- Interface P2P simplifiÃ©e -->
                    <div id="chatRoomInterface" class="chat-room-interface">
                        <div class="chat-room-content">
                            <div class="chat-room-icon">ğŸ®</div>
                            <h3>Mode Multijoueur</h3>
                            <p style="margin-bottom: 20px; color: #666; text-align: center;">
                                Jouez ensemble avec famille et amis ! ğŸ‰
                            </p>

                            <div style="text-align: center; padding: 20px; background: #fff5f9; border-radius: 12px;">
                                <p style="font-size: 15px; margin-bottom: 12px; color: #666;">
                                    âœ¨ <strong>Nouveau systÃ¨me intuitif</strong>
                                </p>
                                <p style="font-size: 13px; color: #888; margin-bottom: 15px;">
                                    1ï¸âƒ£ Connectez-vous et partagez votre code par email, SMS, message privÃ©
                                </p>
                                <p style="font-size: 12px; color: #999; margin-top: 15px;">
                                    ğŸ’¡ Simple, rapide et sÃ©curisÃ© !
                                </p>
                            </div>

                            <p style="font-size: 11px; color: #999; margin-top: 20px; text-align: center;">
                                ğŸ’¬ Astuce: La bulle de chat Ã  gauche montre tous les joueurs en ligne
                            </p>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Modal Multijoueur -->
    <!-- Bulle de chat flottante avec liste des connectÃ©s -->
    <div id="chatBubble" class="chat-bubble">
        <div class="chat-bubble-header">
            <div class="header-title">
                <span class="pulse-dot"></span>
                <span>Partage Famille/Amis</span>
                <span class="online-count" id="onlineCount">0</span>
            </div>
            <button class="minimize-btn" id="toggleChatBubble">âˆ’</button>
        </div>
        <div class="chat-bubble-body" id="chatBubbleBody">
            <!-- Bouton Connexion -->
            <div class="room-actions">
                <button id="chatConnexionBtn" class="room-action-btn connexion-btn">
                    ğŸ‘¤ Connexion
                </button>
            </div>
            
            <!-- SÃ©lecteur de Mode -->
            <div class="mode-selector">
                <button class="mode-dropdown-btn" id="modeDropdownBtn">
                    <span class="mode-current-icon">ğŸ™</span>
                    <span class="mode-current-name">Mode Normal</span>
                    <span class="mode-current-count">(77)</span>
                    <span class="dropdown-arrow">â–¼</span>
                </button>
                <div class="mode-dropdown-menu" id="modeDropdownMenu">
                    <button class="mode-option active" data-mode="normal">
                        <span class="mode-icon">ğŸ™</span>
                        <span class="mode-name">Normal</span>
                        <span class="mode-desc">(77 niveaux)</span>
                    </button>
                    <button class="mode-option" data-mode="couple">
                        <span class="mode-icon">ğŸ’•</span>
                        <span class="mode-name">Couple</span>
                        <span class="mode-desc">(122 niveaux)</span>
                    </button>
                    <button class="mode-option" data-mode="sagesse">
                        <span class="mode-icon">ğŸ•Šï¸</span>
                        <span class="mode-name">Sagesse</span>
                        <span class="mode-desc">(88 sagesses divines)</span>
                    </button>
                    <button class="mode-option" data-mode="proverbes">
                        <span class="mode-icon">ğŸ“–</span>
                        <span class="mode-name">Proverbes</span>
                        <span class="mode-desc">(88 proverbes bibliques)</span>
                    </button>
                    <button class="mode-option" data-mode="disciple">
                        <span class="mode-icon">âœï¸</span>
                        <span class="mode-name">Disciple</span>
                        <span class="mode-desc">(88 vers l'amour vrai)</span>
                    </button>
                    <button class="mode-option" data-mode="veiller">
                        <span class="mode-icon">ğŸ‘ï¸</span>
                        <span class="mode-name">Veiller</span>
                        <span class="mode-desc">(88 vertus vs maux)</span>
                    </button>
                    <button class="mode-option" data-mode="aimee">
                        <span class="mode-icon">â¤ï¸</span>
                        <span class="mode-name">AimÃ©e</span>
                        <span class="mode-desc">(88 aimer Dieu & autrui)</span>
                    </button>
                    <button class="mode-option" data-mode="race">
                        <span class="mode-icon">ğŸ</span>
                        <span class="mode-name">Course</span>
                        <span class="mode-desc">(5 min chrono)</span>
                    </button>
                </div>
            </div>
            
            <!-- Actions salle -->
            <div class="room-actions">
                <button id="createRoomBtn" class="room-action-btn create-btn">
                    ğŸ  CrÃ©er une salle
                </button>
                <div class="join-room-group">
                    <input type="text" id="roomCodeInput" class="room-code-input" placeholder="CODE" maxlength="6">
                    <button id="joinRoomBtn" class="room-action-btn join-btn">
                        ğŸšª Rejoindre
                    </button>
                </div>
                <div id="currentRoomInfo" class="current-room-info hidden">
                    <span class="room-label">Salle:</span>
                    <span class="room-code" id="currentRoomCode">------</span>
                    <button id="leaveRoomBtn" class="leave-room-btn">âŒ</button>
                </div>
            </div>
            <!-- Barre de recherche -->
            <div class="chat-search-bar">
                <input type="text" id="playerSearchInput" class="player-search-input" placeholder="ğŸ” Rechercher un joueur...">
            </div>
            <!-- Liste des joueurs connectÃ©s -->
            <div class="connected-players-list" id="connectedPlayersList">
                <div class="empty-room-message">
                    <p>ğŸ‘¥ Aucun joueur connectÃ©</p>
                    <p style="font-size: 0.9rem; color: #999;">CrÃ©ez ou rejoignez une salle !</p>
                </div>
            </div>
        </div>
    </div>

    <div id="multiplayerModal" class="kawaii-modal hidden">
        <div class="kawaii-modal-overlay"></div>
        <div class="kawaii-modal-content room-system-modal">
            <div class="kawaii-modal-header">
                <span class="kawaii-modal-icon">ğŸ </span>
            </div>
            <div class="kawaii-modal-body">
                <h3>Salles Multijoueur</h3>
                <p>Chaque joueur a sa propre salle automatique !</p>
                
                <!-- Panel de contrÃ´le hÃ´te -->
                <div id="hostControlPanel" class="host-panel hidden">
                    <div class="panel-section">
                        <h4>âš™ï¸ ParamÃ¨tres de Connexion</h4>
                        <div class="room-mode-selector">
                            <label>Mode d'acceptation:</label>
                            <select id="acceptModeSelect" class="kawaii-input">
                                <option value="manual">âœ‹ Manuel (je valide chaque demande hors salle CODE)</option>
                                <option value="auto">âœ… Toujours accepter (mÃªme hors salle CODE)</option>
                            </select>
                        </div>
                        <div class="room-info">
                            <span class="room-mode-display" id="roomModeDisplay">âœ‹ Manuel (Auto en salle CODE)</span>
                            <span class="room-player-count">
                                Joueurs: <strong id="roomPlayerCount">1/8</strong>
                            </span>
                        </div>
                    </div>

                    <!-- Demandes en attente -->
                    <div id="pendingRequestsContainer" class="panel-section hidden">
                        <h4>ğŸ”” Demandes d'AccÃ¨s</h4>
                        <div id="pendingRequestsList" class="requests-list"></div>
                    </div>

                    <!-- Joueurs dans la salle -->
                    <div class="panel-section">
                        <h4>ğŸ‘¥ Joueurs dans la Salle</h4>
                        <div id="roomPlayersList" class="room-players-list"></div>
                    </div>
                </div>

                <!-- Liste des joueurs disponibles (pour joindre) -->
                <div id="availablePlayersPanel" class="available-players-panel">
                    <!-- La liste est gÃ©nÃ©rÃ©e dynamiquement par room-system.js -->
                </div>
            </div>
            <div class="kawaii-modal-footer">
                <button id="leaveRoomBtn" class="kawaii-modal-button secondary hidden">ğŸ‘‹ Quitter la Salle</button>
                <button id="closeMultiplayerBtn" class="kawaii-modal-button secondary">Fermer</button>
            </div>
        </div>
    </div>

    <!-- Modal de Collection de MÃ©dailles -->
    <div id="achievementsModal" class="kawaii-modal hidden">
        <div class="kawaii-modal-overlay"></div>
        <div class="kawaii-modal-content achievements-modal-content">
            <div class="menu-header">
                <h2>ğŸ† Collection de MÃ©dailles</h2>
                <button id="closeAchievementsBtn" class="close-menu-btn">âœ•</button>
            </div>

            <!-- Stats globales -->
            <div class="achievements-stats">
                <div class="stat-item">
                    <div class="stat-value" id="achievementCount">0/0</div>
                    <div class="stat-label">MÃ©dailles Jeu</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="achievementPoints">0</div>
                    <div class="stat-label">Points Jeu</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="raceMedalCount">0/112</div>
                    <div class="stat-label">MÃ©dailles Course</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="racePoints">0</div>
                    <div class="stat-label">Points Course</div>
                </div>
            </div>

            <!-- Section MÃ©dailles de Course (mise en avant) -->
            <div class="race-medals-section">
                <div class="section-header">
                    <h3>ğŸƒ MÃ©dailles de Score Course - Mots Inspirants</h3>
                    <p class="section-description">DÃ©bloquez 112 mÃ©dailles basÃ©es sur des mots chrÃ©tiens optimistes en jouant en mode course !</p>
                </div>
                <div class="race-medals-grid" id="raceMedalsGrid">
                    <!-- GÃ©nÃ©rÃ© dynamiquement -->
                </div>
            </div>

            <!-- Filtres -->
            <div class="achievements-filters">
                <button class="filter-btn active" data-filter="all">Toutes</button>
                <button class="filter-btn" data-filter="unlocked">DÃ©bloquÃ©es</button>
                <button class="filter-btn" data-filter="locked">VerrouillÃ©es</button>
            </div>

            <!-- Liste des achievements -->
            <div id="achievementsList" class="achievements-list"></div>
        </div>
    </div>

    <!-- Modal d'authentification -->
    <div id="authModal" class="kawaii-modal hidden">
        <div class="kawaii-modal-overlay"></div>
        <div class="kawaii-modal-content auth-modal-content">
            <div class="kawaii-modal-header">
                <span class="kawaii-modal-icon">ğŸ”</span>
            </div>
            <div class="kawaii-modal-body">
                <h2 id="authModalTitle" style="color: #ff69b4; margin-bottom: 15px;">Inscription au Chat</h2>
                <p style="color: #666; margin-bottom: 20px;">CrÃ©ez un compte pour utiliser le chat communautaire</p>

                <!-- Formulaire de connexion/inscription -->
                <form id="authForm" style="display: flex; flex-direction: column; gap: 15px;">
                    <input
                        type="text"
                        id="authUsername"
                        placeholder="Nom d'utilisateur"
                        required
                        maxlength="20"
                        style="padding: 12px; border: 2px solid #ffe8f0; border-radius: 10px; font-size: 0.95rem; outline: none;"
                    >
                    <input
                        type="email"
                        id="authEmail"
                        placeholder="Votre email"
                        required
                        style="padding: 12px; border: 2px solid #ffe8f0; border-radius: 10px; font-size: 0.95rem; outline: none;"
                    >
                    <input
                        type="password"
                        id="authPassword"
                        placeholder="Mot de passe (min. 6 caractÃ¨res)"
                        required
                        minlength="6"
                        style="padding: 12px; border: 2px solid #ffe8f0; border-radius: 10px; font-size: 0.95rem; outline: none;"
                    >

                    <div id="authMessage" style="padding: 10px; border-radius: 8px; display: none; font-size: 0.9rem;"></div>

                    <button
                        type="submit"
                        id="authSubmitBtn"
                        class="kawaii-modal-button"
                        style="width: 100%;"
                    >
                        ğŸ” S'inscrire
                    </button>
                </form>

                <p style="font-size: 0.85rem; color: #666; margin-top: 15px; text-align: center;">
                    <span id="authToggleText">DÃ©jÃ  un compte ?</span>
                    <a href="#" id="authToggleLink" style="color: #ff69b4; font-weight: bold; text-decoration: none; margin-left: 5px;">Se connecter</a>
                </p>
                <p id="forgotPasswordLink" style="font-size: 0.9rem; color: #888; margin-top: 12px; text-align: center; display: none;">
                    <a href="#" id="forgotPasswordBtn" style="color: #667eea; text-decoration: none; font-weight: 500; transition: all 0.3s;">
                        ğŸ”‘ Mot de passe oubliÃ© ?
                    </a>
                </p>
            </div>
            <div class="kawaii-modal-footer">
                <button id="authCancelBtn" class="kawaii-modal-button secondary">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modules JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <!-- Supabase v2 avec bundle UMD pour Ã©viter les erreurs de module -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.min.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/config.js"></script>
    <script src="js/i18n.js"></script>
    <!-- Modules de traduction par mode -->
    <script src="data/clues-sagesse-fr.js"></script>
    <script src="data/clues-proverbes-fr.js"></script>
    <script src="data/clues-disciple-fr.js"></script>
    <script src="data/clues-veiller-fr.js"></script>
    <script src="data/clues-aimee-fr.js"></script>
    <!-- AgrÃ©gateur des modules de traduction -->
    <script src="data/clues-fr.js"></script>
    <script src="js/gameData.js"></script>
    <script src="js/coupleChretienData.js"></script>
    <script src="data/levels-sagesse.js"></script>
    <script src="data/levels-proverbes.js"></script>
    <script src="data/levels-disciple.js"></script>
    <script src="data/levels-veiller.js"></script>
    <script src="data/levels-aimee.js"></script>
    <script src="js/achievements.js"></script>
    <script src="js/race-medals.js"></script>
    <script src="js/biblicalQuotes.js"></script>
    <script src="js/shareImage.js"></script>
    <script src="js/supabase.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/simple-chat.js"></script>
    <script src="js/presence-system.js"></script>
    <script src="js/room-manager.js"></script>
    <script src="js/room-system.js"></script>
    <script src="js/room-ui.js"></script>
    <!-- ai-bots.js supprimÃ© - Seul Sophie (welcome-ai.js) est utilisÃ© maintenant -->
    <script src="js/multiplayer-race.js"></script>
    <script src="js/race-ui.js"></script>
    <script src="js/leaderboard.js"></script>
    <script src="js/menu-tabs.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/chat-ui.js"></script>
    <script src="js/info-banner.js"></script>
    <script src="js/multiplayer.js"></script>
    <script src="js/game.js"></script>

    <!-- Service Worker Registration -->
    <script>
        // Enregistrer le Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Utiliser le chemin relatif pour GitHub Pages
                const swPath = window.location.hostname === 'unispourlapaix.github.io' 
                    ? '/mots-en-croix-chretiens/service-worker.js'
                    : '/service-worker.js';
                    
                navigator.serviceWorker.register(swPath)
                    .then((registration) => {
                        console.log('âœ… Service Worker enregistrÃ©:', registration.scope);
                        
                        // VÃ©rifier les mises Ã  jour
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // Nouvelle version disponible
                                    if (confirm('ğŸ‰ Nouvelle version disponible ! Voulez-vous mettre Ã  jour ?')) {
                                        newWorker.postMessage({ type: 'SKIP_WAITING' });
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('âŒ Erreur Service Worker:', error);
                    });
            });

            // GÃ©rer les mises Ã  jour du Service Worker
            let refreshing = false;
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                if (!refreshing) {
                    refreshing = true;
                    window.location.reload();
                }
            });
        }

        // GÃ©rer l'Ã©vÃ©nement d'installation de la PWA
        let deferredPrompt;
        const installButton = document.getElementById('installButton');
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Afficher le bouton d'installation
            if (installButton) {
                installButton.classList.remove('hidden');
                installButton.addEventListener('click', async () => {
                    if (deferredPrompt) {
                        deferredPrompt.prompt();
                        const { outcome } = await deferredPrompt.userChoice;
                        console.log(`Installation: ${outcome}`);
                        deferredPrompt = null;
                        installButton.classList.add('hidden');
                    }
                });
            }
        });

        // DÃ©tecter quand l'app est installÃ©e
        window.addEventListener('appinstalled', () => {
            console.log('ğŸ‰ Application installÃ©e avec succÃ¨s!');
            if (installButton) {
                installButton.classList.add('hidden');
            }
            deferredPrompt = null;
        });
    </script>
    <!-- Configuration locale (clÃ©s API sÃ©curisÃ©es) -->
    <script src="js/config.local.js"></script>
    <script src="js/ai-simulator.js"></script>
    <script src="js/welcome-ai.js"></script>
    <script src="js/unisona-ai.js"></script>
    <script src="js/dreamer-ai.js"></script>
    <script src="js/tutorial-system.js"></script>
    <script>
        // Le tutorial sera dÃ©marrÃ© aprÃ¨s l'intro, quand le jeu commence
        // Message de bienvenue initial d'Unisona (espacÃ©)
        window.addEventListener('load', () => {
            // Premier message : Bienvenue d'Unisona uniquement
            setTimeout(() => {
                if (window.simpleChatSystem && !localStorage.getItem('tutorialCompleted')) {
                    window.simpleChatSystem.showMessage(
                        "Coucou ! ğŸ‘‹ Je suis Unisona, ton assistante virtuelle ! Clique 7 fois sur â–¶ï¸ JOUER pour commencer l'aventure ! ğŸ¬âœ¨",
                        'ai',
                        'Unisona'
                    );
                }
            }, 3000);
        });
        
        // Message d'info IA APRÃˆS que le jeu soit dÃ©marrÃ© (intro terminÃ©e)
        document.addEventListener('gameStarted', () => {
            setTimeout(() => {
                if (window.simpleChatSystem && window.unisonaAI && window.unisonaAI.checkIfEnabled()) {
                    window.simpleChatSystem.showMessage(
                        "âœ¨ Je suis connectÃ©e Ã  l'IA ! Tu peux me parler librement dans le chat ! ğŸ’¬",
                        'ai',
                        'Unisona'
                    );
                }
            }, 2000);
        });
    </script>
</body>
</html>
